(()=>{"use strict";class e{static InsertFunc=async({inObjectToInsert:e={}})=>{let t={KTF:!1,KResult:""};try{let a="Bookings.json",n=await Neutralino.filesystem.readFile(`./KData/JSON/TemplateData/${a}`),s=JSON.parse(n),i=await Neutralino.filesystem.readFile(`./KData/JSON/2017/${a}`),l=JSON.parse(i),o=Object.keys(l),r=1;if(o.length>0){let e=this.CommonFuns.toNumbers(o);r=Math.max(...e)+1}let c=_.pick(e,Object.keys(s));c.DateTime=this.CommonFuns.LocalGetDate(),l[r]=c,(await Neutralino.filesystem.writeFile(`./KData/JSON/2017/${a}`,JSON.stringify(l))).success&&(t.KResult=`${r} saved successfully...`,t.KTF=!0)}catch(e){console.log("error InsertFunc : ",e)}return await t};static UpdateFunc=async({inRowPK:e})=>{let t={KTF:!1,KResult:""},a=await Neutralino.filesystem.readFile("./KData/JSON/2017/Bookings.json"),n=JSON.parse(a);return e in n&&(n[e].WashingDone={KTF:!0,DateTime:this.CommonFuns.LocalGetDate()},(await Neutralino.filesystem.writeFile("./KData/JSON/2017/Bookings.json",JSON.stringify(n))).success&&(t.KTF=!0,t.KResult=`${e} deleted successfully...`)),await t};static ShowTodayFunc=async()=>{let e={KTF:!1,KResult:"",JsonData:{}},t=await Neutralino.filesystem.readFile("./KData/JSON/2017/Bookings.json"),a=JSON.parse(t),n=Object.keys(a).map((e=>({key:e,value:a[e]}))),s=_.filter(n,(e=>!("WashingDone"in e.value)||!0===e.value.WashingDone.KTF==0));return e.JsonData=s,console.log("LocalReturnObject : ",e),await e};static Scan=async({inObjectToInsert:e={}})=>{let t={KTF:!1,KResult:""};try{let a="Bookings.json",n=await Neutralino.filesystem.readFile(`./KData/JSON/TemplateData/${a}`),s=JSON.parse(n),i=await Neutralino.filesystem.readFile(`./KData/JSON/2017/${a}`),l=JSON.parse(i),o=Object.keys(l),r=1;if(o.length>0){let e=this.CommonFuns.toNumbers(o);r=Math.max(...e)+1}let c=_.pick(e,Object.keys(s));c.DateTime=this.CommonFuns.LocalGetDate(),l[r]=c,(await Neutralino.filesystem.writeFile(`./KData/JSON/2017/${a}`,JSON.stringify(l))).success&&(t.KResult=`${r} saved successfully...`,t.KTF=!0)}catch(e){console.log("error InsertFunc : ",e)}return await t};static CommonFuns={toNumbers:e=>e.map(Number),LocalGetDate:()=>{let e=new Date;return`${(e.getDate()<10?"0":"")+e.getDate()}-${(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)}-${e.getFullYear()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}`},LocalGetDateOnly:()=>{let e=new Date;return`${(e.getDate()<10?"0":"")+e.getDate()}-${(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)}-${e.getFullYear()}`}}}class t{static JSFuncs={Insert:async()=>{let t=document.getElementById("FormVertical");if(t.classList.remove("was-validated"),t.classList.add("novalidate"),t.checkValidity()){let a=await e.Booking.InsertFunc({inObjectToInsert:serializeObject(t)});if(a.KTF){let e=document.getElementById("AlertSuccessId"),t=document.getElementById("AlertSuccessMessageId");e.style.display="",t.innerHTML=`<strong>Hurray!</strong> ${a.KResult}`,setTimeout((function(){e.style.display="none"}),7e3)}else{let e=document.getElementById("AlertWarningId"),t=document.getElementById("AlertWarningMessageId");e.style.display="",t.innerHTML=`<strong>Sorry!</strong> ${a.KReason}`,setTimeout((function(){e.style.display="none"}),7e3)}}else document.forms[1].classList.add("was-validated")},Show:async()=>{let t={KTF:!1,KResult:"",JsonData:{}},a=await e.ShowTodayFunc(),n=1;return Object.entries(a.JsonData).forEach((([e,a])=>{t.JsonData[e]=a,t.JsonData[e].SNo=n,n+=1})),t.KTF=!0,await t},Update:async()=>{let e={KTF:!1,KResult:"",JsonData:{}},t=await DalWashingClass.UpdateFunc(),a=1;return Object.entries(t.JsonData).forEach((([t,n])=>{e.JsonData[t]=n,e.JsonData[t].SNo=a,a+=1})),e.KTF=!0,await e}};static ApiFuncs={Update:async e=>{if(void 0===e==0){let t=e.currentTarget;this.CommonFuncs.Ui.Html.DOM.Header.ChangeClass({inHtmlControl:t})}let t=await this.HtmlFuns.Hbs.Update();var a=Handlebars.compile(t);let n=await this.JSFuncs.Update();n.KTF;let s=a(n.JsonData);document.getElementById("KCont1").innerHTML=s},Show:async e=>{if(void 0===e==0){let t=e.currentTarget;this.CommonFuncs.Ui.Html.DOM.Header.ChangeClass({inHtmlControl:t})}let t=await this.HtmlFuns.Hbs.Show();var a=Handlebars.compile(t);let n=await this.JSFuncs.Show();console.log("jVarLocalDataNeeded : ",n),n.KTF;let s=a(n.JsonData);document.getElementById("KCont1").innerHTML=s},Show1:async e=>{if(void 0===e==0){let t=e.currentTarget;this.CommonFuncs.Ui.Html.DOM.Header.ChangeClass({inHtmlControl:t})}await this.Booking.HtmlFuns.Templates.Show();let t=await this.Booking.JSFuncs.Show(),a=await this.Booking.HtmlFuns.Hbs.Row();t.KTF;let n=Handlebars.compile(a)(t.JsonData);document.getElementById("KTableBody").innerHTML=n},Header:{ShowinDOM:async()=>{let e=await this.HtmlFuns.Templates.Header.PullFunc();document.getElementById("KHeader").innerHTML=e,this.ApiFuncs.Header.CommonFuncs.AddListeners()},CommonFuncs:{AddListeners:()=>{document.getElementById("HomeId").addEventListener("click",(async()=>{await a.ApiFuncs.Header.BuildMenu(),document.getElementById("KCont1").innerHTML=""}))}}}};static HtmlFuns={Templates:{Header:{PullFunc:async()=>{let e=await fetch("Templates/Completed/Header.html"),t=await e.text();return await t}},Show:async()=>{let e=await fetch("Templates/Booking/Show.html"),t=await e.text();document.getElementById("KCont1").innerHTML=t},Insert:async()=>{let e=await fetch("Templates/Booking/Insert.html"),t=await e.text();return await t}},Hbs:{Row:async()=>{let e=await fetch("Hbs/Booking/Row.html"),t=await e.text();return await t},QrCode:async()=>{let e=await fetch("Hbs/Booking/QrCode.html"),t=await e.text();return await t},Show:async()=>{let e=await fetch("Hbs/Completed/Completed.html"),t=await e.text();return await t},Update:async()=>{let e=await fetch("Hbs/Washing/ToComplete.html"),t=await e.text();return await t}}};static CommonFuncs={Ui:{Html:{DOM:{Header:{ChangeClass:({inHtmlControl:e})=>{let t=e.closest("ul").querySelectorAll("a"),a="text-info",n="text-white";t.forEach((e=>{e.classList.contains(a)&&(e.classList.remove(a),e.classList.add(n))})),e.classList.remove(n),e.classList.add(a)}}}}}}}class a{static ApiFuncs={Header:{BuildMenu:async()=>{let e=await this.HtmlFuns.Templates.Header.BuildMenu();document.getElementById("KHeader").innerHTML=e;let t=document.getElementById("BookingId"),a=document.getElementById("WashingCompletedId");t.addEventListener("click",(async()=>{await this.ApiFuncs.Header.MenuItemClick.Booking()})),a.addEventListener("click",(async()=>{await this.ApiFuncs.Header.MenuItemClick.Completed()}))},MenuItemClick:{Booking:async()=>{s.ApiFuncs.Header.ShowinDOM(),s.ApiFuncs.Insert()},Completed:async()=>{t.ApiFuncs.Header.ShowinDOM(),t.ApiFuncs.Show()}}}};static HtmlFuns={Templates:{Header:{BuildMenu:async()=>{let e=await fetch("Templates/Header.html"),t=await e.text();return await t}},Show:async()=>{let e=await fetch("Templates/Booking/Show.html"),t=await e.text();document.getElementById("KCont1").innerHTML=t},Insert:async()=>{let e=await fetch("Templates/Booking/Insert.html"),t=await e.text();return await t}},Hbs:{Row:async()=>{let e=await fetch("Hbs/Booking/Row.html"),t=await e.text();return await t},QrCode:async()=>{let e=await fetch("Hbs/Booking/QrCode.html"),t=await e.text();return await t},ShowAll:async()=>{let e=await fetch("Hbs/Booking/ShowAll.html"),t=await e.text();return await t},ShowDataForDelete:async()=>{let e=await fetch("Hbs/Booking/Delete.html"),t=await e.text();return await t}}}}class n{static InsertFunc=async({inObjectToInsert:e={}})=>{let t={KTF:!1,KResult:""};try{let a="Bookings.json",n=await Neutralino.filesystem.readFile(`./KData/JSON/TemplateData/${a}`),s=JSON.parse(n),i=await Neutralino.filesystem.readFile(`./KData/JSON/2017/${a}`),l=JSON.parse(i),o=Object.keys(l),r=1;if(o.length>0){let e=this.CommonFuns.toNumbers(o);r=Math.max(...e)+1}let c=_.pick(e,Object.keys(s));c.DateTime=this.CommonFuns.LocalGetDate(),l[r]=c,(await Neutralino.filesystem.writeFile(`./KData/JSON/2017/${a}`,JSON.stringify(l))).success&&(t.KResult=`${r} saved successfully...`,t.KTF=!0)}catch(e){console.log("error InsertFunc : ",e)}return await t};static ShowTodayFunc=async()=>{let e={KTF:!1,KResult:"",JsonData:{}};try{let t="./KData/JSON/2017/Bookings.json",a=await Neutralino.filesystem.readFile(t),n=JSON.parse(a),s=Object.keys(n).map((e=>({key:e,value:n[e]}))),i=_.filter(s,(e=>{if("DateTime"in e.value)return e.value.DateTime.substring(0,10)===this.CommonFuns.GetDateOnly()}));e.JsonData=i,e.KTF=!0}catch(t){e.KError=t}return await e};static ShowDataForDelete=async()=>{let e={KTF:!1,KResult:"",JsonData:{}};try{let t="./KData/JSON/2017/Bookings.json",a=await Neutralino.filesystem.readFile(t),n=JSON.parse(a),s=Object.keys(n).map((e=>({key:e,value:n[e]}))),i=_.filter(s,(e=>{if("DateTime"in e.value)return e.value.DateTime.substring(0,10)===this.CommonFuns.GetDateOnly()}));e.JsonData=i,e.KTF=!0}catch(t){e.KError=t}return await e};static PickFunc=async({inRowPK:e})=>{let t={KTF:!1,KResult:""},a=await Neutralino.filesystem.readFile("./KData/JSON/2017/Bookings.json"),n=JSON.parse(a);return e in n&&(t.KTF=!0,t.KResult=n[e]),await t};static CommonFuns={toNumbers:e=>e.map(Number),LocalGetDate:()=>{let e=new Date;return`${(e.getDate()<10?"0":"")+e.getDate()}-${(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)}-${e.getFullYear()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}`},GetDateOnly:()=>{let e=new Date;return`${(e.getDate()<10?"0":"")+e.getDate()}-${(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)}-${e.getFullYear()}`}}}class s{static JSFuncs={Show:async()=>{let e={KTF:!1,KResult:"",JsonData:{}},t=await n.ShowTodayFunc(),a=1;return Object.entries(t.JsonData).forEach((([t,n])=>{e.JsonData[t]=n,e.JsonData[t].SNo=a,a+=1})),e.KTF=!0,await e},ShowDataForDelete:async()=>{let e={KTF:!1,KResult:"",JsonData:{}},t=await DalFuncsClass.Booking.ShowDataForDelete(),a=1;return Object.entries(t.JsonData).forEach((([t,n])=>{e.JsonData[t]=n,e.JsonData[t].SNo=a,a+=1})),e.KTF=!0,await e}};static ApiFuncs={SaveFunc:async()=>{let e=document.getElementById("FormVertical");if(e.classList.remove("was-validated"),e.classList.add("novalidate"),e.checkValidity()){let t=await n.InsertFunc({inObjectToInsert:this.CommonFuncs.serializeObject(e)});if(t.KTF){let e=document.getElementById("AlertSuccessId"),a=document.getElementById("AlertSuccessMessageId");e.style.display="",a.innerHTML=`<strong>Hurray!</strong> ${t.KResult}`,setTimeout((function(){e.style.display="none"}),7e3)}else{let e=document.getElementById("AlertWarningId"),a=document.getElementById("AlertWarningMessageId");e.style.display="",a.innerHTML=`<strong>Sorry!</strong> ${t.KReason}`,setTimeout((function(){e.style.display="none"}),7e3)}}else document.forms[1].classList.add("was-validated")},Insert:async e=>{if(void 0===e==0){let t=e.currentTarget;this.CommonFuncs.Ui.Html.DOM.Header.ChangeClass({inHtmlControl:t})}let t=await this.HtmlFuns.Templates.Insert();document.getElementById("KCont1").innerHTML=t,document.getElementById("BookingSaveButtonId").addEventListener("click",(async()=>{await this.ApiFuncs.SaveFunc()}))},QrCode:{ShowAll:async e=>{if(void 0===e==0){let t=e.currentTarget;this.CommonFuncs.Ui.Html.DOM.Header.ChangeClass({inHtmlControl:t})}let t=await this.HtmlFuns.Hbs.QrCode();var a=Handlebars.compile(t);let n=await this.JSFuncs.Show();n.KTF;let s=a(n.JsonData);document.getElementById("KCont1").innerHTML=s,this.ApiFuncs.QrCode.CommonFuncs.AddListeners()},ToModal:async({inRowPK:e})=>{let t=await n.PickFunc({inRowPK:e});if(console.log("jVarLocalDataNeeded : ",t),t.KTF){let a=document.getElementById("ModalCustomerName"),n=document.getElementById("ModalPK"),s=document.getElementById("ModalGarments"),i=document.getElementById("ModalWeight"),l=document.getElementById("ModalMobile");a.innerHTML=t.KResult.CustomerName,n.innerHTML=e,s.innerHTML=t.KResult.Garments,i.innerHTML=`${t.KResult.Weight} Kg.`,l.innerHTML=t.KResult.Mobile;let o=`${e}/${t.KResult.CustomerName}/${t.KResult.Mobile}/${t.KResult.Garments}/${t.KResult.Weight}`;this.CommonFuncs.QrCode.GenerateQrCodeOnCanvas({inQrData:o});let r="ModalForQrCode";new bootstrap.Modal(document.getElementById(r),{keyboard:!0,focus:!0}).show()}},CommonFuncs:{AddListeners:()=>{let e=document.getElementsByClassName("QrCodeButtonClass");for(var t=0;t<e.length;t++)e[t].addEventListener("click",(async e=>{let t=e.currentTarget.closest("tr").dataset.qrcode;this.ApiFuncs.QrCode.ToModal({inRowPK:t})}))}}},ShowDataForDelete:async e=>{if(void 0===e==0){let t=e.currentTarget;this.CommonFuncs.Ui.Html.DOM.Header.ChangeClass({inHtmlControl:t})}let t=await this.Booking.HtmlFuns.Hbs.ShowDataForDelete();var a=Handlebars.compile(t);let n=await this.Booking.JSFuncs.Show();n.KTF;let s=a(n.JsonData);document.getElementById("KCont1").innerHTML=s},ShowAll:async e=>{if(void 0===e==0){let t=e.currentTarget;this.CommonFuncs.Ui.Html.DOM.Header.ChangeClass({inHtmlControl:t})}let t=await this.HtmlFuns.Hbs.ShowAll();var a=Handlebars.compile(t);let n=await this.JSFuncs.Show();n.KTF;let s=a(n.JsonData);document.getElementById("KCont1").innerHTML=s},Show:async e=>{if(void 0===e==0){let t=e.currentTarget;this.CommonFuncs.Ui.Html.DOM.Header.ChangeClass({inHtmlControl:t})}await this.Booking.HtmlFuns.Templates.Show();let t=await this.Booking.JSFuncs.Show(),a=await this.Booking.HtmlFuns.Hbs.Row();t.KTF;let n=Handlebars.compile(a)(t.JsonData);document.getElementById("KTableBody").innerHTML=n},Header:{ShowinDOM:async()=>{let e=await this.HtmlFuns.Templates.Header.PullFunc();document.getElementById("KHeader").innerHTML=e;let t=document.getElementById("HomeId"),n=document.getElementById("BookingHeaderTodayId"),s=document.getElementById("BookingHeaderShowAllId"),i=document.getElementById("BookingHeaderInsertId"),l=document.getElementById("BookingHeaderQrCodeId");t.addEventListener("click",(async()=>{await a.ApiFuncs.Header.BuildMenu(),document.getElementById("KCont1").innerHTML=""})),n.addEventListener("click",(async()=>{await this.ApiFuncs.Show()})),s.addEventListener("click",(async()=>{await this.ApiFuncs.ShowAll()})),i.addEventListener("click",(async()=>{await this.ApiFuncs.Insert()})),l.addEventListener("click",(async()=>{await this.ApiFuncs.QrCode.ShowAll()}))},MenuItemClick:{HomeClick:async()=>{let e=await this.HtmlFuns.Templates.Header.MenuItemClick.HomeClick();document.getElementById("KHeader").innerHTML=e,document.getElementById("KCont1").innerHTML=""}}}};static HtmlFuns={Templates:{Header:{MenuItemClick:{HomeClick:async()=>{let e=await fetch("Templates/Header.html"),t=await e.text();return await t}},PullFunc:async()=>{let e=await fetch("Templates/Booking/Header.html"),t=await e.text();return await t}},Show:async()=>{let e=await fetch("Templates/Booking/Show.html"),t=await e.text();document.getElementById("KCont1").innerHTML=t},Insert:async()=>{let e=await fetch("Templates/Booking/Insert.html"),t=await e.text();return await t}},Hbs:{Row:async()=>{let e=await fetch("Hbs/Booking/Row.html"),t=await e.text();return await t},QrCode:async()=>{let e=await fetch("Hbs/Booking/QrCode.html"),t=await e.text();return await t},ShowAll:async()=>{let e=await fetch("Hbs/Booking/ShowAll.html"),t=await e.text();return await t},ShowDataForDelete:async()=>{let e=await fetch("Hbs/Booking/Delete.html"),t=await e.text();return await t}}};static CommonFuncs={serializeObject:e=>{const t=new FormData(e),a={};for(const[e,n]of t)a[e]=n;return a},QrCode:{GenerateQrCodeOnCanvas:({inQrData:e=""})=>{var t=document.getElementById("canvas");t.height=1,t.width=1,t.style.visibility="hidden";let a={};a.text=e,a.bcid="qrcode",a.scaleX=1,a.scaleY=1,a.rotate="N";try{new Date,bwipjs.toCanvas(t,a),new Date,t.style.visibility="visible"}catch(e){return void console.log("error : ",e)}}},Ui:{Html:{DOM:{Header:{ChangeClass:({inHtmlControl:e})=>{let t=e.closest("ul").querySelectorAll("a"),a="text-info",n="text-white";t.forEach((e=>{e.classList.contains(a)&&(e.classList.remove(a),e.classList.add(n))})),e.classList.remove(n),e.classList.add(a)}}}}}}}(async()=>{await s.ApiFuncs.Header.ShowinDOM(),await s.ApiFuncs.Insert()})().then((e=>{}))})();